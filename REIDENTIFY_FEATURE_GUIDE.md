# AI上架精靈重新識別功能

## 功能概述

現在AI上架精靈支持在識別完成後重新拍照或上傳照片，而不需要退出重新進入。

## 新增功能

### 1. 智能AppBar按鈕
- **初始狀態**：顯示返回按鈕（←）
- **識別完成後**：顯示重新識別按鈕（🔄）

### 2. 重新識別選項面板
點擊重新識別按鈕會彈出底部選項面板，包含：
- 📷 **拍照識別**：使用相機拍攝新照片
- 🖼️ **從相簿選擇**：從相簿選擇新照片
- 🗑️ **清除結果**：清除當前識別結果，回到初始狀態
- ← **返回上一頁**：退出AI上架精靈

### 3. 結果頁面快速按鈕
在識別結果摘要區域添加了「重新識別」按鈕，方便用戶快速重新識別。

## 用戶體驗改進

### 之前
1. 用戶拍照識別
2. 查看結果
3. 想要重新識別時需要：
   - 按返回鍵退出
   - 重新進入AI上架精靈
   - 重新拍照

### 現在
1. 用戶拍照識別
2. 查看結果
3. 想要重新識別時：
   - 點擊AppBar的重新識別按鈕
   - 或點擊結果摘要的重新識別按鈕
   - 選擇拍照或從相簿選擇
   - 立即開始新的識別流程

## 測試步驟

### 步驟1：進入AI上架精靈
1. 打開應用
2. 點擊AI智能助手
3. 點擊「AI上架精靈」

### 步驟2：第一次識別
1. 點擊「拍照識別」或「從相簿選擇」
2. 選擇照片
3. 等待識別完成
4. 觀察AppBar按鈕變為重新識別按鈕（🔄）

### 步驟3：測試重新識別功能
1. **方法1**：點擊AppBar左上角的重新識別按鈕
2. **方法2**：點擊結果摘要區域的「重新識別」按鈕
3. 選擇重新識別選項：
   - 拍照識別
   - 從相簿選擇
   - 清除結果
   - 返回上一頁

### 步驟4：驗證功能
- 重新識別後應該顯示新的識別結果
- 清除結果後應該回到初始狀態
- 返回上一頁應該退出AI上架精靈

## 界面變化

### AppBar變化
```
初始狀態: [←] AI上架精靈 [匯入草稿]
識別完成: [🔄] AI上架精靈 [匯入草稿]
```

### 結果摘要變化
```
識別完成 [重新識別]
找到 X 本書籍
已選擇 Y 本書籍
```

## 技術實現

### 1. 動態AppBar
- 使用Consumer監聽Provider狀態
- 根據是否有識別結果動態切換按鈕

### 2. 底部選項面板
- 使用showModalBottomSheet顯示選項
- 提供多種重新識別方式

### 3. 狀態管理
- 保持現有的Provider狀態管理
- 重新識別時會更新識別結果

## 用戶反饋

這個改進解決了用戶在識別結果不滿意時需要重新進入的痛點，提供了更流暢的用戶體驗。

## 未來擴展

1. **批量重新識別**：支持一次重新識別多張照片
2. **識別歷史**：保存識別歷史記錄
3. **快速重試**：一鍵重新識別當前照片
4. **識別結果比較**：比較不同識別結果的差異

